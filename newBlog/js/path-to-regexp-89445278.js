var x={exports:{}},P=Array.isArray||function(r){return Object.prototype.toString.call(r)=="[object Array]"},E=P;x.exports=C;x.exports.parse=w;x.exports.compile=D;x.exports.tokensToFunction=b;x.exports.tokensToRegExp=A;var j=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function w(r,e){for(var a=[],l=0,p=0,n="",v=e&&e.delimiter||"/",i;(i=j.exec(r))!=null;){var g=i[0],f=i[1],c=i.index;if(n+=r.slice(p,c),p=c+g.length,f){n+=f[1];continue}var t=r[p],u=i[2],o=i[3],h=i[4],S=i[5],d=i[6],m=i[7];n&&(a.push(n),n="");var U=u!=null&&t!=null&&t!==u,I=d==="+"||d==="*",O=d==="?"||d==="*",y=i[2]||v,$=h||S;a.push({name:o||l++,prefix:u||"",delimiter:y,optional:O,repeat:I,partial:U,asterisk:!!m,pattern:$?J($):m?".*":"[^"+s(y)+"]+?"})}return p<r.length&&(n+=r.substr(p)),n&&a.push(n),a}function D(r,e){return b(w(r,e),e)}function F(r){return encodeURI(r).replace(/[\/?#]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function G(r){return encodeURI(r).replace(/[?#]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function b(r,e){for(var a=new Array(r.length),l=0;l<r.length;l++)typeof r[l]=="object"&&(a[l]=new RegExp("^(?:"+r[l].pattern+")$",T(e)));return function(p,n){for(var v="",i=p||{},g=n||{},f=g.pretty?F:encodeURIComponent,c=0;c<r.length;c++){var t=r[c];if(typeof t=="string"){v+=t;continue}var u=i[t.name],o;if(u==null)if(t.optional){t.partial&&(v+=t.prefix);continue}else throw new TypeError('Expected "'+t.name+'" to be defined');if(E(u)){if(!t.repeat)throw new TypeError('Expected "'+t.name+'" to not repeat, but received `'+JSON.stringify(u)+"`");if(u.length===0){if(t.optional)continue;throw new TypeError('Expected "'+t.name+'" to not be empty')}for(var h=0;h<u.length;h++){if(o=f(u[h]),!a[c].test(o))throw new TypeError('Expected all "'+t.name+'" to match "'+t.pattern+'", but received `'+JSON.stringify(o)+"`");v+=(h===0?t.prefix:t.delimiter)+o}continue}if(o=t.asterisk?G(u):f(u),!a[c].test(o))throw new TypeError('Expected "'+t.name+'" to match "'+t.pattern+'", but received "'+o+'"');v+=t.prefix+o}return v}}function s(r){return r.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function J(r){return r.replace(/([=!:$\/()])/g,"\\$1")}function R(r,e){return r.keys=e,r}function T(r){return r&&r.sensitive?"":"i"}function N(r,e){var a=r.source.match(/\((?!\?)/g);if(a)for(var l=0;l<a.length;l++)e.push({name:l,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return R(r,e)}function H(r,e,a){for(var l=[],p=0;p<r.length;p++)l.push(C(r[p],e,a).source);var n=new RegExp("(?:"+l.join("|")+")",T(a));return R(n,e)}function K(r,e,a){return A(w(r,a),e,a)}function A(r,e,a){E(e)||(a=e||a,e=[]),a=a||{};for(var l=a.strict,p=a.end!==!1,n="",v=0;v<r.length;v++){var i=r[v];if(typeof i=="string")n+=s(i);else{var g=s(i.prefix),f="(?:"+i.pattern+")";e.push(i),i.repeat&&(f+="(?:"+g+f+")*"),i.optional?i.partial?f=g+"("+f+")?":f="(?:"+g+"("+f+"))?":f=g+"("+f+")",n+=f}}var c=s(a.delimiter||"/"),t=n.slice(-c.length)===c;return l||(n=(t?n.slice(0,-c.length):n)+"(?:"+c+"(?=$))?"),p?n+="$":n+=l&&t?"":"(?="+c+"|$)",R(new RegExp("^"+n,T(a)),e)}function C(r,e,a){return E(e)||(a=e||a,e=[]),a=a||{},r instanceof RegExp?N(r,e):E(r)?H(r,e,a):K(r,e,a)}export{x as p};
