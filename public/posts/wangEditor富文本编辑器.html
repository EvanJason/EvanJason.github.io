<!doctype html><html class="" data-reactroot=""><head>
<meta data-react-helmet="true" charset="utf-8"/><meta data-react-helmet="true" http-equiv="x-ua-compatible" content="ie=edge"/><meta data-react-helmet="true" name="description" content="前端技术讨论交流，知识杂谈，生活分享。"/><meta data-react-helmet="true" name="viewport" content="width=device-width, initial-scale=1"/><meta data-react-helmet="true" property="og:title" content="wangEditor富文本编辑器 · 深海如梦的作战实践基地"/><meta data-react-helmet="true" property="og:description" content="前端技术讨论交流，知识杂谈，生活分享。"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" name="twitter:card" content="summary"/>
<title data-react-helmet="true">wangEditor富文本编辑器 · 深海如梦的作战实践基地</title>
<link data-react-helmet="true" rel="stylesheet" href="/assets/index.css"/><link data-react-helmet="true" id="prismTheme" rel="stylesheet" href="/assets/prism.css"/>
<script data-react-helmet="true" >
    const shouldSetIsDark = document.cookie.includes('is_dark=1') ? true : document.cookie.includes('is_dark=0') ? false : window.matchMedia('(prefers-color-scheme: dark)').matches;
    if (shouldSetIsDark) {
      document.documentElement.classList.add('is_dark');
      document.getElementById('prismTheme').href = "/assets/prism_tomorrow.css";
    }
  </script>
</head><body><a class="czs-menu-l show_on_mobile aside_button_open" href="#" style="background-image:url(&quot;/assets/czs-menu-l.svg&quot;)"></a><a class="show_on_mobile aside_button_text" href="/">深海如梦的作战实践基地</a><aside class="hide_on_mobile"><div class="aside_card"><a class="czs-menu-l show_on_mobile aside_button_close" href="#" style="background-image:url(&quot;/assets/czs-close-l.svg&quot;)"></a><h1><a href="/">深海如梦的作战实践基地</a></h1><p class="description">前端技术讨论交流，知识杂谈，生活分享。</p><ul class="social list_style_none"><li class="flex_center"><a class="czs-github-logo" href="https://github.com/yourhug" target="_blank" style="background-image:url(&quot;/assets/czs-github-logo.svg&quot;)"></a></li><li class="flex_center"><a class="czs-message-l" href="mailto:linkenmum@163.com" target="_blank" style="background-image:url(&quot;/assets/czs-message-l.svg&quot;)"></a></li><li style="flex-grow:1"></li><li class="toggle_dark flex_center"><span class="czs-sun" style="background-image:url(&quot;/assets/czs-sun.svg&quot;)"></span><span class="czs-sun-l" style="background-image:url(&quot;/assets/czs-sun-l.svg&quot;)"></span><span class="czs-moon" style="background-image:url(&quot;/assets/czs-moon.svg&quot;)"></span><span class="czs-moon-l" style="background-image:url(&quot;/assets/czs-moon-l.svg&quot;)"></span></li></ul><nav><ul class="menu list_style_none"><li><a class="flex_center" href="/"><span class="czs-home-l" style="background-image:url(&quot;/assets/czs-home-l.svg&quot;)"></span>首页</a></li><li><a class="flex_center" href="/categories/"><span class="czs-category-l" style="background-image:url(&quot;/assets/czs-category-l.svg&quot;)"></span>分类</a></li><li><a class="flex_center" href="/tags/"><span class="czs-tag-l" style="background-image:url(&quot;/assets/czs-tag-l.svg&quot;)"></span>标签</a></li><li><a class="flex_center" href="/about/"><span class="czs-about-l" style="background-image:url(&quot;/assets/czs-about-l.svg&quot;)"></span>关于</a></li><li><a class="flex_center" href="/archives/"><span class="czs-box-l" style="background-image:url(&quot;/assets/czs-box-l.svg&quot;)"></span>归档</a></li><li><a class="flex_center" href="/links/"><span class="czs-link-l" style="background-image:url(&quot;/assets/czs-link-l.svg&quot;)"></span>友情链接</a></li></ul></nav></div></aside><section class="main"><h1>wangEditor富文本编辑器</h1><div class="main_post_meta"><time dateTime="Mon Nov 23 2020 16:20:21 GMT+0800 (中国标准时间)">2020-11-23</time> · <!-- -->深海如梦</div><article><p>npm i wangeditor</p>
<p>对应的页面</p>
<p>组件 ts</p>
<pre class="language-typescript"><code class="language-typescript"><span class="token keyword">import</span> wangEditor <span class="token keyword">from</span> <span class="token string">'wangeditor'</span><span class="token punctuation">;</span>


 <span class="token comment">//wang富文本编辑器</span>
  wEditor<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">;</span>
  <span class="token function">wangEditorInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>wEditor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">wangEditor</span><span class="token punctuation">(</span><span class="token string">'#wangEditor'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 配置菜单栏，删减菜单，调整顺序</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>wEditor<span class="token punctuation">.</span>config<span class="token punctuation">.</span>menus <span class="token operator">=</span> <span class="token punctuation">[</span>
      <span class="token string">"bold"</span><span class="token punctuation">,</span> <span class="token comment">// 粗体</span>
      <span class="token string">"italic"</span><span class="token punctuation">,</span> <span class="token comment">// 斜体</span>
      <span class="token string">"underline"</span><span class="token punctuation">,</span> <span class="token comment">// 下划线</span>
      <span class="token string">"head"</span><span class="token punctuation">,</span> <span class="token comment">// 标题</span>
      <span class="token string">"fontName"</span><span class="token punctuation">,</span> <span class="token comment">// 字体</span>
      <span class="token string">"fontSize"</span><span class="token punctuation">,</span> <span class="token comment">// 字号</span>
      <span class="token string">"strikeThrough"</span><span class="token punctuation">,</span> <span class="token comment">// 删除线</span>
      <span class="token string">"foreColor"</span><span class="token punctuation">,</span> <span class="token comment">// 文字颜色</span>
      <span class="token string">"backColor"</span><span class="token punctuation">,</span> <span class="token comment">// 背景颜色</span>
      <span class="token string">"link"</span><span class="token punctuation">,</span> <span class="token comment">// 插入链接</span>
      <span class="token string">"list"</span><span class="token punctuation">,</span> <span class="token comment">// 列表</span>
      <span class="token string">"justify"</span><span class="token punctuation">,</span> <span class="token comment">// 对齐方式</span>
      <span class="token string">"quote"</span><span class="token punctuation">,</span> <span class="token comment">// 引用</span>
      <span class="token string">"table"</span><span class="token punctuation">,</span> <span class="token comment">// 表格</span>
      <span class="token comment">// "image", // 插入图片</span>
      <span class="token comment">// 'video',  // 插入视频</span>
      <span class="token string">"code"</span><span class="token punctuation">,</span> <span class="token comment">// 插入代码</span>
      <span class="token string">"undo"</span><span class="token punctuation">,</span> <span class="token comment">// 撤销</span>
      <span class="token string">"redo"</span><span class="token punctuation">,</span> <span class="token comment">// 重复</span>
      <span class="token string">"fullscreen"</span><span class="token punctuation">,</span> <span class="token comment">// 全屏</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token comment">// 设置编辑区域高度为 500px</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>wEditor<span class="token punctuation">.</span>config<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">500</span><span class="token punctuation">;</span>

    <span class="token comment">// 提示语</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>wEditor<span class="token punctuation">.</span>config<span class="token punctuation">.</span>placeholder <span class="token operator">=</span> <span class="token string">" "</span><span class="token punctuation">;</span>

    <span class="token comment">/* --------------------图片上传------------------------------ */</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>wEditor<span class="token punctuation">.</span>config<span class="token punctuation">.</span>uploadImgAccept <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"jpg"</span><span class="token punctuation">,</span> <span class="token string">"jpeg"</span><span class="token punctuation">,</span> <span class="token string">"png"</span><span class="token punctuation">,</span> <span class="token string">"gif"</span><span class="token punctuation">,</span> <span class="token string">"bmp"</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 限制图片类型</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>wEditor<span class="token punctuation">.</span>config<span class="token punctuation">.</span>uploadImgMaxLength <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span> <span class="token comment">// 一次最多上传 5 个图片</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>wEditor<span class="token punctuation">.</span>config<span class="token punctuation">.</span>uploadImgServer <span class="token operator">=</span>
      environment<span class="token punctuation">.</span>customerManagementUrl <span class="token operator">+</span> <span class="token string">"/chat/img/uploadImg"</span><span class="token punctuation">;</span> <span class="token comment">// 配置图片上传服务端接口</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>wEditor<span class="token punctuation">.</span>config<span class="token punctuation">.</span>uploadImgParams <span class="token operator">=</span> <span class="token punctuation">{</span>
      adminId<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>adminId<span class="token punctuation">,</span>
      gameUserId<span class="token operator">:</span> <span class="token string">"-1"</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">// this.wEditor.config.uploadImgParamsWithUrl = true // 需要将参数拼接到 url 中，可再加上如下配置。</span>
    <span class="token comment">// this.wEditor.config.uploadImgParams = {   // 自定义上传参数</span>
    <span class="token comment">//   // gameUserId: -1,</span>
    <span class="token comment">// }</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>wEditor<span class="token punctuation">.</span>config<span class="token punctuation">.</span>uploadFileName <span class="token operator">=</span> <span class="token string">"fileName"</span><span class="token punctuation">;</span> <span class="token comment">// 自定义 fileName</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>wEditor<span class="token punctuation">.</span>config<span class="token punctuation">.</span>uploadImgShowBase64 <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">//使用 base64 格式保存图片</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>wEditor<span class="token punctuation">.</span>config<span class="token punctuation">.</span>uploadImgHooks <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token comment">// 上传图片超时</span>
      <span class="token function-variable function">timeout</span><span class="token operator">:</span> <span class="token punctuation">(</span>xhr<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"超时"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>

      <span class="token function-variable function">customInsert</span><span class="token operator">:</span> <span class="token punctuation">(</span>insertImg<span class="token punctuation">,</span> result<span class="token punctuation">,</span> Editor<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
        <span class="token comment">// result 即服务端返回的接口</span>
        <span class="token comment">// console.log('customInsert', result);</span>

        <span class="token comment">// insertImgFn 可把图片插入到编辑器，传入图片 src ，执行函数即可</span>
        <span class="token function">insertImg</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment">// 配置 onchange 回调函数</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>wEditor<span class="token punctuation">.</span>config<span class="token punctuation">.</span><span class="token function-variable function">onchange</span> <span class="token operator">=</span> <span class="token punctuation">(</span>newHtml<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
      <span class="token comment">// console.log('change后最新的 html：', newHtml);</span>

      <span class="token comment">// 对图片进行处理</span>
      <span class="token keyword">let</span> html <span class="token operator">=</span> newHtml<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">100%</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">"300px"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>knowledgeContent <span class="token operator">=</span> html<span class="token punctuation">;</span>
      <span class="token comment">// console.log(this.knowledgeContent);</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment">// 注意，先配置 height ，再执行 create()</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>wEditor<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>


<span class="token function">ngOnInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">wangEditorInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 	 <span class="token keyword">this</span><span class="token punctuation">.</span>wEditor<span class="token punctuation">.</span>txt<span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>knowledgeContent<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre>
<p>组件html</p>
<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>wangEditor<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
</code></pre></article></section><footer>Powered by&amp;nbsp;<a href="https://github.com/xcatliu/pagic" target="_blank">Pagic</a></footer><script src="https://cdn.pagic.org/react@16.13.1/umd/react.production.min.js"></script><script src="https://cdn.pagic.org/react-dom@16.13.1/umd/react-dom.production.min.js"></script><script type="module" src="/index.js"></script></body></html>